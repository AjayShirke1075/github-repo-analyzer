<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="GitHub repository analyzer - Get instant insights and tech stack detection">
    <title>GitHub Repo Analyzer | Repository Analysis</title>

    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700;800&display=swap" rel="stylesheet">

    <!-- Stylesheet -->
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>

<body>
    <div class="container">

        <!-- Header -->
        <header class="header">
            <h1>âš¡ GitHub Repo Analyzer</h1>
            <p class="subtitle">Professional Repository Intelligence</p>
            <p class="description">
                Analyze any GitHub repository instantly. Get comprehensive insights,
                detailed metrics, and detect tech stacks.
            </p>
        </header>

        <!-- FORM (IMPORTANT: everything is inside ONE form) -->
        <section class="form-section">
            <form method="POST" id="analyzeForm">

                <!-- Repo URL -->
                <div class="input-wrapper">
                    <input type="text"
                           name="repo_url"
                           id="repo_url"
                           placeholder="Enter GitHub repository URL (e.g., https://github.com/user/repo)"
                           required>
                </div>

                <!-- Project Intent -->
                <textarea
                    name="project_intent"
                    rows="6"
                    placeholder="Explain what this repository is about, its goal, and how it is intended to be used..."
                    style="width:100%; margin-top:16px; padding:16px; border-radius:12px;">
                </textarea>
                {% if project_intent_report %}
                <div class="card">
                    <h2>ğŸ¯ Project Intent vs Reality Report</h2>

                    <h4>âœ… Matches</h4>
                    {% for item in project_intent_report.matches %}
                    <p>âœ” {{ item }}</p>
                    {% endfor %}

                    <h4 style="margin-top:12px;">âš  Warnings</h4>
                    {% for item in project_intent_report.warnings %}
                    <p>âš  {{ item }}</p>
                    {% endfor %}

                    <h4 style="margin-top:12px;">âŒ Missing</h4>
                    {% for item in project_intent_report.missing %}
                    <p>âŒ {{ item }}</p>
                    {% endfor %}
                </div>
                {% endif %}

                <!-- Submit -->
                <button type="submit" id="analyzeBtn">
                    ğŸ” Analyze Repository
                </button>

            </form>
        </section>

        <!-- Error -->
        {% if error_message %}
        <div class="card" style="border-color: var(--color-danger); background: rgba(239,68,68,0.1);">
            <h2>âš ï¸ Error</h2>
            <p>{{ error_message }}</p>
        </div>
        {% endif %}

        {% if repo_info %}
        {% if readiness_report %}
<div class="card">
    <h2>ğŸš€ Production Readiness</h2>

    <h3>{{ readiness_report.badge }}</h3>
    <p><strong>Score:</strong> {{ readiness_report.score }} / 100</p>

    <ul>
        {% for reason in readiness_report.reasons %}
        <li>âœ” {{ reason }}</li>
        {% endfor %}
    </ul>
</div>
{% endif %}

        <div class="results">

            <!-- Repository Overview -->
            <div class="card">
                <h2>ğŸ“Š Repository Overview</h2>

                <div class="repo-header">
                    <img src="{{ repo_info.avatar_url }}" class="repo-avatar">
                    <div class="repo-title">
                        <h3>{{ repo_info.name }}</h3>
                        <p>{{ repo_info.description }}</p>
                    </div>
                </div>

                <div class="stats-grid">
                    <div class="stat-item"><div class="stat-label">â­ Stars</div><div class="stat-value">{{ repo_info.stars }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ´ Forks</div><div class="stat-value">{{ repo_info.forks }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ‘ï¸ Watchers</div><div class="stat-value">{{ repo_info.watchers }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ› Issues</div><div class="stat-value">{{ repo_info.open_issues }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ’» Language</div><div class="stat-value">{{ repo_info.language }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ“… Created</div><div class="stat-value">{{ repo_info.created_at }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ”„ Updated</div><div class="stat-value">{{ repo_info.updated_at }}</div></div>
                    <div class="stat-item"><div class="stat-label">ğŸ“ Size</div><div class="stat-value">{{ repo_info.size }} KB</div></div>
                </div>
            </div>
            {% if readiness_report %}
            <div class="card">
                <h2>ğŸ“Š Repository Readiness Score</h2>

                <div style="font-size: 2.5rem; font-weight: 800; margin-bottom: 12px;">
                    {{ readiness_report.score }}/100
                </div>

                {% for item in readiness_report.details %}
                <p>â€¢ {{ item }}</p>
                {% endfor %}
        </div>
        {% endif %}

            <!-- Project Intent Display -->
            {% if project_intent %}
            <div class="card">
                <h2>ğŸ¯ Project Intent Analysis</h2>
                <p style="white-space: pre-wrap; line-height:1.7; color: var(--color-text-secondary);">
                    {{ project_intent }}
                </p>
            </div>
            {% endif %}

            <!-- Tech Stack -->
            {% if tech_stack %}
            <div class="card">
                <h2>ğŸ› ï¸ Detected Tech Stack</h2>
                <div class="tech-grid">
                    {% for tech in tech_stack %}
                    <div class="tech-item">
                        <div class="tech-icon">
                            {% if tech == "Python" %}ğŸ
                            {% elif "pip" in tech %}ğŸ“¦
                            {% elif "Docker" in tech %}ğŸ³
                            {% elif "Git" in tech %}ğŸ”§
                            {% elif "API" in tech %}ğŸ”Œ
                            {% else %}âš™ï¸
                            {% endif %}
                        </div>
                        <div class="tech-name">{{ tech }}</div>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}

            <!-- AI Suggestions -->
            {% if ai_suggestions %}
            <div class="card">
                <h2>ğŸ¤– AI-Powered Suggestions</h2>
                <div style="
                    background: rgba(59,130,246,0.08);
                    border: 1px solid rgba(59,130,246,0.25);
                    border-radius: 12px;
                    padding: 20px;
                    white-space: pre-wrap;
                ">
                    {{ ai_suggestions }}
                </div>
            </div>
            {% endif %}

        </div>
        {% endif %}
        <a href="/download-pdf" class="btn" style="margin-top:20px; display:inline-block;">
            ğŸ“„ Download Analysis Report (PDF)
        </a>

        <!-- Footer -->
        <footer class="footer">
            <p>Built with â¤ï¸ using Flask</p>
        </footer>

    </div>

    <script src="{{ url_for('static', filename='script.js') }}"></script>
</body>
</html>
